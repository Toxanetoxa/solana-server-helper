# –ò–º—è –ø—Ä–æ–µ–∫—Ç–∞ (–º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å)
PROJECT_NAME := fee-app

# Docker Compose –±–∏–Ω–∞—Ä—å (–µ—Å–ª–∏ —É —Ç–µ–±—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –ø–ª–∞–≥–∏–Ω: docker compose, –∞ –Ω–µ docker-compose)
COMPOSE := docker compose

# --------------------------
# –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
# --------------------------

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ (app + redis)
up:
	@echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ Redis..."
	$(COMPOSE) up --build -d

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–æ–¥-—Å—Ç–µ–∫–∞
up-prod:
	@echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–¥-–≤–µ—Ä—Å–∏—é (app + redis)..."
	$(COMPOSE) -f docker-compose.prod.yml up --build -d

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–Ω–æ –Ω–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–º–æ–≤)
down:
	@echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
	$(COMPOSE) down

## –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã + —Å–µ—Ç—å + —Ç–æ–º–∞
clean:
	@echo "üßπ –ü–æ–ª–Ω–æ—Å—Ç—å—é —á–∏—Å—Ç–∏–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–≤–∫–ª—é—á–∞—è Redis –¥–∞–Ω–Ω—ã–µ)..."
	$(COMPOSE) down -v

## –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ Redis
rebuild:
	@echo "üîÑ –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ..."
	$(COMPOSE) build app
	$(COMPOSE) up -d app

# --------------------------
# –£–¥–æ–±–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
# --------------------------

## –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
logs:
	@echo "üìú –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:"
	$(COMPOSE) logs -f app

## –õ–æ–≥–∏ Redis
logs-redis:
	@echo "üìú –õ–æ–≥–∏ Redis:"
	$(COMPOSE) logs -f redis

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ shell –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
sh-app:
	@echo "üîß –ó–∞—Ö–æ–¥–∏–º –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
	$(COMPOSE) exec app sh

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ Redis CLI
sh-redis:
	@echo "üîß –û—Ç–∫—Ä—ã–≤–∞–µ–º redis-cli..."
	$(COMPOSE) exec redis redis-cli

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
ps:
	$(COMPOSE) ps

# --------------------------
# –•–µ–ª–ø (–æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥)
# --------------------------

## –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
help:
	@echo "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
	@echo "  make up         - —Å–æ–±—Ä–∞—Ç—å –∏ –ø–æ–¥–Ω—è—Ç—å –≤–µ—Å—å —Å—Ç–µ–∫ (app + redis)"
	@echo "  make up-prod    - –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–æ–¥-—Å—Ç–µ–∫–∞"
	@echo "  make down       - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã"
	@echo "  make clean      - –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å –≤—Å—ë (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã + —Ç–æ–º–∞)"
	@echo "  make rebuild    - –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
	@echo "  make logs       - –ø–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
	@echo "  make logs-redis - –ø–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ Redis"
	@echo "  make sh-app     - –æ—Ç–∫—Ä—ã—Ç—å shell –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
	@echo "  make sh-redis   - –æ—Ç–∫—Ä—ã—Ç—å redis-cli –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Redis"
	@echo "  make ps         - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"
